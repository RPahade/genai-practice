<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>Research Dashboard</h2>
        <div class="d-flex gap-2">
            <button (click)="toggleTheme()" class="btn btn-outline-secondary" title="Toggle Theme">
                <i class="fas" [ngClass]="themeService.isDarkMode ? 'fa-sun' : 'fa-moon'"></i>
            </button>
            <button (click)="logout()" class="btn btn-outline-danger">Logout</button>
        </div>
    </div>

    <div class="container mt-5">
        <div class="d-flex justify-content-between align-items-center mb-5">
            <div>
                <h1 class="mb-1">Welcome to your dashboard, young researcher!</h1>
                <p class="text-muted">Manage and track your research jobs</p>
            </div>
            <button class="btn btn-primary" routerLink="/jobs/create">
                <i class="fas fa-plus me-2"></i> New Research Job
            </button>
        </div>

        <div class="row">
            <div class="col-md-4 mb-4" *ngFor="let job of jobs">
                <div class="glass-card h-100 p-4 d-flex flex-column">
                    <div class="d-flex justify-content-between align-items-start mb-3">
                        <span class="badge rounded-pill" [ngClass]="{
                            'bg-warning text-dark': job.status === 'pending',
                            'bg-info text-white': job.status === 'running',
                            'bg-success': job.status === 'completed',
                            'bg-danger': job.status === 'failed'
                        }">
                            {{job.status | titlecase}}
                        </span>
                        <small class="text-muted">{{job.created_at | date:'shortDate'}}</small>
                    </div>

                    <h5 class="card-title mb-3">{{job.topic}}</h5>

                    <div class="mt-auto">
                        <button *ngIf="job.status === 'completed'" class="btn btn-outline-light btn-sm w-100"
                            [routerLink]="['/report', job.id]">
                            View Report <i class="fas fa-arrow-right ms-2"></i>
                        </button>
                        <p *ngIf="job.status !== 'completed'" class="text-muted small mb-0">
                            <i class="fas fa-sync fa-spin me-1" *ngIf="job.status === 'running'"></i>
                            Processing...
                        </p>
                    </div>
                </div>
            </div>

            <div class="col-12 text-center mt-5" *ngIf="jobs.length === 0">
                <div class="glass-card p-5 d-inline-block">
                    <i class="fas fa-search fa-3x text-muted mb-3"></i>
                    <h3 class="text-muted">No research jobs yet</h3>
                    <p class="text-muted mb-4">Start your first research project today.</p>
                    <button class="btn btn-primary" routerLink="/jobs/create">Create Job</button>
                </div>
            </div>
        </div>
    </div>
</div>